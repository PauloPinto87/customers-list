<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF‑8" />
    <meta name="viewport" content="width=device‑width, initial‑scale=1" />
  <base href="./" />
  <meta name="theme-color" content="#00A6A0" />
  <!-- iOS support for standalone mode -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>Customers List Tour 2025</title>
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js')
          .then(reg => {
            console.log('Service Worker registrado.');

            // If there's an updated SW already waiting, prompt the user
            if (reg.waiting) {
              if (confirm('Nova versão disponível. Atualizar agora?')) {
                reg.waiting.postMessage({ type: 'SKIP_WAITING' });
              }
            }

            reg.addEventListener('updatefound', () => {
              const newWorker = reg.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // new update available
                  if (confirm('Nova versão disponível. Atualizar agora?')) {
                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                  }
                }
              });
            });

            // When the new SW activates, reload to get the new content
            navigator.serviceWorker.addEventListener('controllerchange', () => {
              window.location.reload();
            });
          })
          .catch(err => console.error('Erro ao registrar SW:', err));
      }
    </script>
    <link rel="manifest" href="manifest.json" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>
      <img src="flag-pt.png" alt="Portugal flag" class="flag" /> Tour November
      2025 <img src="flag-jp.png" alt="Japan flag" class="flag" />
    </h1>
    <input
      type="text"
      id="filterLocation"
      placeholder="Filter by location (district or locality)"
    />
    <div id="clientsList"><!-- JS inserts clients here --></div>
    <script src="app.js"></script>
  </body>
</html>
